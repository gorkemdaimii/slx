<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Åževvale Sevgilerle ðŸ’•</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        @keyframes heartBurst {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -120px) scale(1);
                opacity: 0;
            }
        }

        @keyframes envelopeSend {
            0% { transform: scale(0.8) translateY(40px); opacity: 0; }
            20% { opacity: 1; }
            50% { transform: scale(1) translateY(0); }
            100% { transform: scale(0.7) translateY(-200px); opacity: 0; }
        }

        @keyframes envelopeOpen {
            0% { transform: rotateX(90deg); opacity: 0; }
            100% { transform: rotateX(0deg); opacity: 1; }
        }

        .animate-float { animation: float linear infinite; }
        .animate-heartBurst { animation: heartBurst 1s ease-out forwards; }
    </style>
</head>

<body>
    <div id="root"></div>

    <script>
        const firebaseConfig = {
             apiKey: "AIzaSyBzF_kGylIuZKu2DnlOuMc-cU3YJwTGCHA",
             authDomain: "sevvals-239d0.firebaseapp.com",
             projectId: "sevvals-239d0",
             storageBucket: "sevvals-239d0.firebasestorage.app",
             messagingSenderId: "727817694816",
             appId: "1:727817694816:web:7282a82008d29ee0665d05",
             measurementId: "G-2KS65T0TRP"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Heart = ({ size = 24, className = "", style = {} }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
                fill="none" stroke="currentColor" strokeWidth="2"
                className={className} style={style} viewBox="0 0 24 24">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
            </svg>
        );

        const Send = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
                fill="none" stroke="currentColor" strokeWidth="2"
                viewBox="0 0 24 24">
                <path d="m22 2-7 20-4-9-9-4Z"/>
                <path d="M22 2 11 13"/>
            </svg>
        );

        const Trash2 = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
                fill="none" stroke="currentColor" strokeWidth="2"
                viewBox="0 0 24 24">
                <path d="M3 6h18"/>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
                <line x1="10" x2="10" y1="11" y2="17"/>
                <line x1="14" x2="14" y1="11" y2="17"/>
            </svg>
        );

        const Sparkles = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
                fill="none" stroke="currentColor" strokeWidth="2"
                viewBox="0 0 24 24">
                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                <path d="M5 3v4"/>
                <path d="M19 17v4"/>
                <path d="M3 5h4"/>
                <path d="M17 19h4"/>
            </svg>
        );

        const AlertCircle = ({ size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
                fill="none" stroke="currentColor" strokeWidth="2"
                viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
        );

        // ðŸ’Œ Mektup Animasyonu
        function LetterAnimation({ text, onFinish }) {
            useEffect(() => {
                const timeout = setTimeout(() => onFinish(), 1500);
                return () => clearTimeout(timeout);
            }, []);

            return (
                <div className="fixed inset-0 flex items-center justify-center z-[9999] pointer-events-none">
                    <div className="bg-white shadow-2xl border border-rose-300 rounded-xl px-6 py-4"
                        style={{ animation: "envelopeSend 1.5s ease-out forwards" }}>
                        
                        <p className="text-rose-500 font-bold text-xl text-center mb-2">
                            ðŸ’Œ Mektup GÃ¶nderiliyor...
                        </p>

                        <p className="text-gray-700 text-center whitespace-pre-wrap">
                            {text}
                        </p>
                    </div>
                </div>
            );
        }

        function MessageWall() {
            const [messages, setMessages] = useState([]);
            const [newMessage, setNewMessage] = useState('');
            const [senderName, setSenderName] = useState('');
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            const [sending, setSending] = useState(false);
            const [tempLetter, setTempLetter] = useState('');

            useEffect(() => {
                const unsubscribe = db.collection('messages')
                    .orderBy('timestamp', 'desc')
                    .onSnapshot((snapshot) => {
                        setMessages(snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        })));
                        setLoading(false);
                    });

                return () => unsubscribe();
            }, []);

            const addMessage = () => {
                if (!newMessage.trim() || !senderName.trim()) return;

                setTempLetter(newMessage);
                setSending(true);

                setTimeout(async () => {
                    const msg = {
                        text: newMessage,
                        sender: senderName,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        color: `hsl(${Math.random() * 360}, 70%, 65%)`
                    };

                    await db.collection('messages').add(msg);

                    setNewMessage('');
                }, 900);
            };

            const deleteMessage = (id) => {
                db.collection('messages').doc(id).delete();
            };

            if (loading) {
                return (
                    <div className="h-screen flex items-center justify-center bg-pink-500 text-white text-3xl font-bold">
                        YÃ¼kleniyor...
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-rose-400 via-pink-500 to-purple-600 p-6 relative">
                    
                    {sending && (
                        <LetterAnimation
                            text={tempLetter}
                            onFinish={() => setSending(false)}
                        />
                    )}

                    <div className="max-w-2xl mx-auto">

                        <div className="bg-white/30 backdrop-blur-xl p-6 rounded-3xl text-center mb-6">
                            <h1 className="text-white text-5xl font-bold flex justify-center gap-3">
                                <Sparkles size={40}/> Åževvale Sevgilerle <Sparkles size={40}/>
                            </h1>
                            <p className="text-white mt-1">Seni dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼m her an burada ðŸ’•</p>
                        </div>

                        {/* Input */}
                        <div className="bg-white p-5 rounded-2xl shadow-xl mb-6">
                            <input 
                                type="text"
                                placeholder="Ä°smin ðŸ’•"
                                className="w-full border p-3 rounded-xl mb-3"
                                value={senderName}
                                onChange={(e) => setSenderName(e.target.value)}
                            />

                            <textarea
                                placeholder="MesajÄ±n ðŸ’Œ"
                                className="w-full border p-3 rounded-xl"
                                rows="3"
                                value={newMessage}
                                onChange={(e) => setNewMessage(e.target.value)}
                            ></textarea>

                            <button
                                onClick={addMessage}
                                className="mt-4 w-full bg-rose-500 hover:bg-rose-600 text-white p-3 rounded-xl font-bold flex justify-center items-center gap-2"
                            >
                                <Send size={20}/> GÃ¶nder
                            </button>
                        </div>

                        {/* Messages */}
                        <div className="space-y-4">
                            {messages.map((m) => (
                                <div key={m.id} className="bg-white p-5 rounded-2xl shadow-xl">
                                    
                                    <div className="flex justify-between">
                                        <div>
                                            <p className="font-bold" style={{ color: m.color }}>
                                                {m.sender}
                                            </p>
                                            <p className="text-gray-500 text-sm">
                                                {m.timestamp?.toDate().toLocaleString("tr-TR")}
                                            </p>
                                        </div>
                                        
                                        <button
                                            onClick={() => deleteMessage(m.id)}
                                            className="text-red-500 hover:text-red-700"
                                        >
                                            <Trash2 size={20}/>
                                        </button>
                                    </div>

                                    <p className="text-gray-800 mt-3 whitespace-pre-wrap">
                                        {m.text}
                                    </p>
                                </div>
                            ))}
                        </div>

                    </div>

                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById("root")).render(<MessageWall/>);
    </script>
</body>
</html>
